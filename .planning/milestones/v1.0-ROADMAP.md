# Milestone v1.0: Esercizi di Gruppo

**Status:** ✅ SHIPPED 2026-01-28
**Phases:** 1-4
**Total Plans:** 6

## Overview

4 fasi per implementare gli esercizi di gruppo mantenendo backward compatibility.

## Phases

### Phase 1: Database Schema

**Goal**: Aggiungere colonna is_group a session_exercises
**Depends on**: None
**Plans**: 1 plan
**Status**: Complete (2026-01-28)

Plans:
- [x] 01-01: Migration + TypeScript types + CLAUDE.md update

**Details:**
- Migration per aggiungere `is_group BOOLEAN NOT NULL DEFAULT false`
- Partial index for efficient group exercise filtering
- Verifica RLS policies esistenti funzionano
- Test: sessioni esistenti non impattate

---

### Phase 2: MCP Server Integration

**Goal**: Esporre is_group in lettura e scrittura via MCP
**Depends on**: Phase 1
**Plans**: 1 plan
**Status**: Complete (2026-01-28)

Plans:
- [x] 02-01: Add is_group to MCP resources and tools

**Details:**
- Resource helix://sessions/{id} include is_group negli esercizi
- Tool add_session_exercise accetta parametro is_group
- Tool update_session_exercise accetta parametro is_group
- Tool create_training_plan supporta is_group negli esercizi

---

### Phase 3: UI Pianificazione

**Goal**: Toggle "di gruppo" nella pagina SessionDetail
**Depends on**: Phase 1
**Plans**: 1 plan
**Status**: Complete (2026-01-28)

Plans:
- [x] 03-01: Add group toggle and visual indicators to SessionDetail

**Details:**
- Switch/toggle per is_group su ogni esercizio in SessionDetail
- Indicatore visivo (icon/badge) nella lista esercizi
- Hook useSessions aggiornato per gestire is_group

---

### Phase 4: UI Live Tablet

**Goal**: Vista gruppo con complete-for-all nel live coaching
**Depends on**: Phase 1, Phase 3
**Plans**: 3 plans
**Status**: Complete (2026-01-28)

Plans:
- [x] 04-01: RPC functions + Realtime publication
- [x] 04-02: Hook extension + View toggle
- [x] 04-03: GroupExerciseView + GroupExerciseCard components

**Details:**
- Tab toggle "Individuali" / "Gruppo" in TabletLive
- Vista individuale: comportamento esistente
- Vista gruppo: lista esercizi is_group=true di tutti i clienti del giorno
- Indicatore visivo su ExerciseCard per esercizi di gruppo
- Lista partecipanti per ogni esercizio di gruppo
- Complete-for-all: un tap marca completo per tutti
- Skip individuale: possibilità di saltare per singolo cliente
- RPC function per update atomico cross-session
- Realtime subscription per sync cross-tablet

---

## Milestone Summary

**Decimal Phases:** None

**Key Decisions:**
- Partial index for is_group (WHERE is_group = true) — most exercises not group, saves space
- NOT NULL DEFAULT false — backward compatibility ensured
- SECURITY INVOKER for RPC functions — respects RLS policies
- Toast duration 4 seconds for undo action
- Undo uses individual DB updates (acceptable for rare path)

**Issues Resolved:**
- TypeScript build error in SessionDetail.tsx — fixed by adding is_group to object literal
- Port conflict with lumio project — resolved by stopping lumio first

**Issues Deferred:** None

**Technical Debt Incurred:** None

---

_For current project status, see .planning/ROADMAP.md (will be created for next milestone)_

---
*Archived: 2026-01-28 as part of v1.0 milestone completion*
